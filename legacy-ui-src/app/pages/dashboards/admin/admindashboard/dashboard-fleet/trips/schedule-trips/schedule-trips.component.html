<ngx-spinner bdColor="rgba(0,0,0,0.8)" size="large" color="#fff" type="ball-elastic-dots" [fullScreen]="true">
  <div class="custom-spinner">
    <img src="../../../../../assets/images/spinner3.svg" alt="Your Logo">
  </div>
  <div class="loading-text">Please wait, we are getting information...</div>
</ngx-spinner>
 <!--Main content-->
<div class="page-content page-content-main">
  <div class="row" style="margin-left: 0px; margin-right: 0px;">
    <!-- Left side menu-->
    <div class="col-xs-12 col-lg-2 navbar-side-menu">
      <app-sidebar></app-sidebar>
    </div>
    <!-- Left side menu end -->
    <!-- Right side menu -->
    <div class="col-xs-12 col-lg-10 content-right">
      <!-- Left side heading and right side Breadcrumb-->
      <div class="row">
        <div class="col-xs-12 col-lg-12">
          <span class="breadcrumb-left">
            <h1 class="login-headline heading-title">Schedule Trip Summary
            </h1>
          </span>
          <span class="breadcrumb-right mr-8">
            <ol class="breadcrumb">
              <li class="breadcrumb-item">
                <a routerLink="/adlp/admin/admindashboard/dashboardfleet" class="breadcrumb-h6"><i
                    class="bx bx-home-circle"></i></a>
              </li>
              <li class="breadcrumb-item inactive-bread"> <a
                  routerLink="/adlp/admin/admindashboard/dashboardfleet">Dashboard</a></li>
              <li class="breadcrumb-item text-selected active-bread">Schedule Trip Summary</li>
            </ol>
          </span>
        </div>
      </div>
      <!-- Consumer and Fleet Id Filter-->
<div class="row consumer-pad justify-content-end my-2">
  <div class="col-xs-12 col-lg-2 mr-3" *ngIf="user !='role_user_fleet' && user !='role_Driver' && user != 'role_org_group'">
    <ng-select
      [items]="fleetList"
      bindLabel="name"
      bindValue="id"
      [searchable]="true"
      class="newSelect1"
      [clearable]="true"
      placeholder="Organization Id/Name"
      [(ngModel)]="fleetIdData"
      (change)="onFleetChange($event)">
      <ng-template ng-label-tmp let-item="item">
        {{ item.id }} - [{{ item.name }}]
      </ng-template>
      <ng-template ng-option-tmp let-item="item">
        {{ item.id }} - [{{ item.name }}]
      </ng-template>
    </ng-select>
  </div>

  <!-- <div class="col-xs-12 col-lg-2 mr-3">
    <ng-select
      [searchable]="true"
      class="newSelect1"
      [clearable]="true"
      placeholder="Group Name">
      <ng-option value="101">Group 1</ng-option>
      <ng-option value="102">Group 2</ng-option>
    </ng-select>
  </div> -->
</div>
<!-- Consumer and Fleet Id Filter end-->

      <!-- Left side heading and right side Breadcrumb end-->
      <!-- Consumer and Fleet Id Filter-->
      <div class="row consumer-pad">
          <div class="card-container">
              <div class="card-item card-item-height">
                <div class="card-heading">
                  <div class="row" style="height: 56px;">
                    <div class="col-xs-12 col-lg-6">
                      <img src="../../assets/images/summary.svg" alt="" class="card-heading-img" />Summary
                    </div>
                    <div class="col-xs-12 col-lg-6 d-flex justify-content-end">
                    <div class="fleet-dropdowm" style="width: 160px;">
                      <ng-select bindLabel="label" style="font-family: 'Poppins'!important;"
                          bindValue="value" placeholder="Select Time Period" [(ngModel)]="selectedPeriod"
                          (change)="onTimePeriodChangeData($event)"
                          class="newSelect  timePeriod current-month-dropdown ">
                          <ng-option *ngFor="let period of timePeriods" [value]="period.value">
                              {{ period.label }}
                          </ng-option>
                      </ng-select>
                  </div>
                </div>
                    <!-- <div class="col-xs-12 col-lg-6">
                      <h5 class="active-vehicle">Active Vehicles :
                        <span [ngClass]="{ 'loading-background': isLoading }" style="color:#000000!important">
                          {{
                          isDataNotFound
                          ? "No Data"
                          : (fleetSumamryTotalData?.totalActiveVehicles
                          | number : "1.0-0")
                          }}
                        </span>
                      </h5>
                    </div>  -->

                  </div>

                </div>
                <div class="cards-subsection">
                  <!-- <div class="header-card brdr-red">
                    <div class="header-card-text">
                      <span [ngClass]="{ 'loading-background': isloading2 }" style="line-height: 25px; width: 40%">
                        {{totalTimePeriods}}
                        <ng-container *ngIf="totalTimePeriods">
                          <span style="font-size: 12px; font-weight: 500; font-family: 'Poppins', sans-serif;">
                            hh:mm
                          </span>
                        </ng-container>
                      </span>
                    </div>
                    <div class="content-section-text">Total Duration</div>
                  </div> -->
                  <div class="header-card brdr-red">
                    <div class="header-card-text">
                      <span [ngClass]="{ 'loading-background': isloading2 }" style="line-height: 25px; width: 40%">
                        {{ totalTripCounts }}
                        <ng-container *ngIf="totalTripCounts">
                          <span style="font-size: 12px; font-weight: 500; font-family: 'Poppins', sans-serif;">

                          </span>
                        </ng-container>
                      </span>
                    </div>
                    <div class="content-section-text">Total Trips Completed</div>
                  </div>


                  <div class="header-card brdr-yellow">
                    <div class="header-card-text">
                      <span [ngClass]="{ 'loading-background': isloading2 }" style="line-height: 25px; width: 40%">
                        {{  totalDistance | number:'1.2-2'  }}
                        <ng-container *ngIf="totalDistance">
                          <span style="font-size: 12px; font-weight: 500; font-family: 'Poppins', sans-serif;">
                           miles
                          </span>
                        </ng-container>
                      </span>
                    </div>
                    <div class="content-section-text">Total Distance Travelled</div>
                  </div>
                  <div class="header-card brdr-fuel-consumed">
                    <div class="header-card-text">
                      <span [ngClass]="{ 'loading-background': isloading2 }" style="line-height: 25px; width: 40%">
                        {{ isDataNotFound ? "No Data" : (totalFuelConsumed < 0 ? -totalFuelConsumed : totalFuelConsumed) | number:'1.0-2' }}

                        <ng-container *ngIf="totalFuelConsumed">
                          <span style="font-size: 12px; font-weight: 500; font-family: 'Poppins', sans-serif;">
                            gal
                          </span>
                        </ng-container>
                      </span>
                    </div>
                    <div class="content-section-text">Total Fuel Consumed</div>
                  </div>

                  <div class="header-card brdr-blue">
                    <div class="header-card-text">
                      <span [ngClass]="{ 'loading-background': isloading2 }" style="line-height: 25px; width: 40%">
                        {{ totalFuelConsumedCost | number:'1.2-2' }}
                        <ng-container *ngIf="totalFuelConsumedCost">
                          <span style="font-size: 12px; font-weight: 500; font-family: 'Poppins', sans-serif;">
                            $
                          </span>
                        </ng-container>
                      </span>
                    </div>
                    <div class="content-section-text">Fuel Cost</div>
                  </div>
                  <div class="header-card brdr-green">
                    <div class="header-card-text">
                      <span [ngClass]="{ 'loading-background': isloading2 }" style="line-height: 25px; width: 40%">
                          {{ avgFuelCost | number:'1.2-2' }}
                        <ng-container *ngIf="avgFuelCost">
                          <span style="font-size: 12px; font-weight: 500; font-family: 'Poppins', sans-serif;">
                            $
                          </span>
                        </ng-container>
                      </span>
                    </div>
                    <div class="content-section-text">Avg. Fuel Cost Per Mile</div>
                  </div>

                </div>
              </div>

            </div>
      <!-- Boxed for Total Data End-->
      <!-- VIN, OEM and satus filter -->
      <div class="row">
        <div class="col-lg-6"></div>
        <div class="col-lg-3 d-flex justify-content-end mt-4 mb-2">
          <ng-select
          [items]="driverList"
          bindLabel="fullName"
          bindValue="driverVin"
          placeholder="Select Driver"
          [(ngModel)]="selectedDriver"
          (ngModelChange)="filterByDriver()"
          class="input-vins font-common"
          [ngStyle]="{ 'width': '100%', 'height': '45px' }"
          >
          <ng-template ng-label-tmp let-item="item">
            {{ item.fullName}}
          </ng-template>
          <ng-template ng-option-tmp let-item="item">
            {{ item.fullName }}
          </ng-template>
        </ng-select>

        </div>
        <div class="col-lg-3 d-flex justify-content-end mt-4 mb-2">
          <ng-select
            [items]="vinList"
            bindLabel="alias"
            bindValue="vin"
            placeholder="Select Vehicle VIN"
            [(ngModel)]="selectedVin"
            (ngModelChange)="filterByVin()"
            class="input-vins font-common"
            [ngStyle]="{ 'width': '100%', 'height': '45px' }"
          >
            <ng-template ng-label-tmp let-item="item">
              {{ item.alias }}
            </ng-template>
            <ng-template ng-option-tmp let-item="item">
              {{ item.alias }}
            </ng-template>
          </ng-select>
        </div>
      </div>

      <!-- VIN, OEM and satus filter end -->
      <!-- Main data table-->
      <div class="row mr-table mr-6">
        <div class="col-lg-12 col-xs-12">
          <div class="table-wrapper">
            <div class="table-responsive table-b">
              <table class="table">
                <thead class="table-head">
                  <tr>
                    <th class=" table-column-widthDate">Trip Date</th>
                    <th class="table-column-width2">Trip Name</th>
                    <th class="table-column-width3">Vehicle Name</th>
                    <th class="table-column-width3">VIN</th>
                    <th class="table-column-width3">Driver Name</th>
                    <!-- <th class="table-column-width7">Data Source</th> -->


                    <!-- <th class="time-cell">Start Time</th>
                    <th class="time-cell">End Time</th>   -->
                    <th class="table-column-width1">Total Stops</th>
                    <th class="table-column-width1">Miles Driven</th>
                    <th class="table-column-width3">Trip Duration</th>
                    <!-- <th class="table-column-width7">Odometer (Mile)</th> -->
                    <!-- <th class="table-column-width6">Action</th>       -->

                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngIf="tripSummaryData?.length > 0; else noDataTemplate">
                  <ng-container  *ngFor="let trips of tripSummaryData; let i = index" >
                  <tr class="bor-none">
                    <td><a href="javascript:void()"
                      class="tripIdnewplus"
                      (click)="toggleExpand(i); getScheduleTripHistoryDetails(trips.vin,trips.id,trips.timeZones,trips.deliveryLocations,trips.geometry)">
                      <i class="fas fa-plus tripIdnew"></i> </a>{{  convertUTCintoDateMonth(trips.tripStartDateTime,trips.timeZones)}}</td>
                      <td class="text-left">
                        <span *ngIf="trips?.tripName; else noTripName" [ngbTooltip]="trips.tripName" container="body">
                          {{ trips.tripName.length > 15 ? (trips.tripName | slice:0:15) + '...' : trips.tripName }}
                        </span>
                        <ng-template #noTripName>--</ng-template>
                      </td>

                      <td>
                        <a href="javascript:void(0)" (click)="vinSummary(trips.vin, trips.provider)">
                          {{ trips.vinAlias }}
                        </a>
                      </td>
                      <td>{{trips.vin}}</td>
                      <td>
                        <a [routerLink]="['/adlp/admin/admindashboard/manageDriver/driverSummary', trips.driverId]">
                          {{ trips.driverName }}
                        </a>
                      </td>
                      <!-- <td>{{ trips.vehicleOem == 'CBX' ? 'Dongles': 'OEM Cloud'}}</td> -->


                      <!-- <td class="text-center">{{ trips.startTime}}</td>
                      <td class="text-center">{{ trips.endTime}}</td> -->
                      <td class="text-center">{{ getTotalStops(trips) }}</td>
                      <td class="text-center">{{ trips?.totalTripDistance | number:'1.2-2' }}</td>
                      <td  class="text-center">{{ formatDuration(trips.totalTripDuration)}}</td>

                      <!-- <td class="text-center">{{ trips.maxOdometer |number }}</td> -->


                      <!-- <td class="text-center"><button class="btn btn-primary">View</button></td> -->
                    </tr>
                    <tr *ngIf="expandedRowIndex === i">
                      <td colspan="12">
                        <div class="row">
                          <!-- Trip details like fuel consumed, address, odomerter and more-->
                          <div class="col-md-6">
                            <div class="row">
                              <div class="col-xs-12 col-lg-12">
                                <div class="card">
                                  <div class="card-body"
                                    style="background-color: #F2F2F2; border:1px solid #CCE3D8; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); max-height: 250px;overflow-y: auto !important;">

                                    <!-- Scrollable Container for Locations -->
                                    <div>
                                      <div *ngFor="let location of tripDataNew?.locationDetails; let i = index">

                                        <div class="row py-2">

                                          <!-- Location Icon -->
                                          <div class="col-xs-12 col-lg-1 text-center">
                                            <img *ngIf="location.type === 'START'" src="../../../../../../../../assets/images/locaiton-icon-ember.png" class="green-img">
                                            <img *ngIf="location.type === 'DELIVERY'" src="../../../../../../../../assets/images/locaiton-icon-green.png" class="delivery-img">
                                            <img *ngIf="location.type === 'END'" src="../../../../../../../../assets/images/locaiton-icon-ember.png" class="red-img">
                                            <img *ngIf="i !== tripDataNew?.locationDetails.length - 1" src="../../../../../../../../assets/images/horizontal-line.svg" class="hori-img">
                                          </div>

                                          <!-- Location Details -->
                                          <div class="col-xs-12 col-lg-11">



                                            <!-- Condition: START Location -->
                                            <div *ngIf="location.type === 'START'">
                                               <!-- Address -->
                                              <div class="row">
                                                  <div class="col-12">
                                                    <h5 class="address"><strong>Start Address:</strong> {{ location.streetAddress }}, {{ location.city }}, {{ location.state }} - {{ location.zipcode }}</h5>
                                                  </div>
                                               </div>
                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>Scheduled Start Time:</strong> {{ convertToTimeZone(trips.tripStartDateTime,trips.timeZone) }}</h5>
                                                </div>
                                              </div>
                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>Actual Start Time:</strong> {{ tripDataNew?.startTimeStamp }}</h5>
                                                </div>
                                              </div>
                                            </div>

                                            <!-- Condition: END Location -->
                                            <div *ngIf="location.type === 'END'">
                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>End Address:</strong> {{ location.streetAddress }}, {{ location.city }}, {{ location.state }} - {{ location.zipcode }}</h5>
                                                </div>
                                             </div>
                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>End Time:</strong> {{ tripDataNew?.endTimeStamp }}</h5>
                                                </div>
                                              </div>
                                            </div>

                                            <!-- Condition: Other Locations (Delivery, etc.) -->
                                            <div *ngIf="location.type !== 'START' && location.type !== 'END'">
                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>Address:</strong> {{ location.streetAddress }}, {{ location.city }}, {{ location.state }} - {{ location.zipcode }}</h5>
                                                </div>
                                             </div>
                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>Scheduled Halt Time:</strong> {{ location.haltTime }} mins</h5>
                                                </div>
                                              </div>

                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address"><strong>Actual Halt Time:</strong>  {{ calculateHaltTime(location.timeOfArrival, location.timeOfDeparture) }} </h5>
                                                </div>
                                              </div>

                                              <div class="row">
                                                <div class="col-12">
                                                  <h5 class="address time">
                                                    <strong>Arrival:</strong> {{ location.timeOfArrival  }}
                                                    <strong>Departure:</strong> {{ location.timeOfDeparture }}
                                                  </h5>
                                                </div>
                                              </div>
                                            </div>

                                          </div>
                                        </div>

                                        <hr *ngIf="i !== tripDataNew?.locationDetails.length - 1">

                                      </div>
                                    </div>

                                  </div>
                                </div>
                              </div>
                            </div>




                            <ng-container
                              *ngIf="tripDataNew?.vehicleType === 'Gasoline' || tripDataNew?.vehicleType === 'Diesel' || tripDataNew?.vehicleType === 'Flexible Fuel Vehicle (FFV)'">
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/speed-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Average Speed</h5>
                                      <h5 class="data-params"> {{(tripDataNew?.avgVehicleSpeed) |
                                        number:'1.2-2'}} mph</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/odometer-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Odometer</h5>
                                      <h5 class="data-params">{{tripDataNew?.maxOdometer | number:'1.2-2'}}
                                        miles</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/mileage-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Mileage</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage <= -1">
                                          0.00 mpg
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage > -1">
                                          {{tripDataNew?.vehicleAverage | number:'1.2-2'}} mpg</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/fuelconsumed-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Fuel Consumed</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.totalFuelConsumed <= -1">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelConsumed == null ">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelConsumed > -1">
                                          {{ tripDataNew?.totalFuelConsumed | number:'1.0-2'}} gal</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/fuel-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Fuel Level</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgFuelLevel <= -1">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgFuelLevel === null || tripDataNew?.avgFuelLevel === 'NaN'">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgFuelLevel > -1">
                                          {{tripDataNew?.avgFuelLevel | number:'1.0-2'}} gal</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/fuel-price.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Total Fuel Cost</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.totalFuelCost <= -1">
                                          0.00 $
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelCost === null || tripDataNew?.avgFuelLevel === 'NaN'">
                                          0.00 $
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelCost > -1">
                                          {{tripDataNew?.totalFuelCost | number:'1.0-2'}} $</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/battery-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Battery Level</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.cxEvLevel <= -1">
                                          13.5 V
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.cxEvLevel == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.cxEvLevel > -1">
                                          {{tripDataNew?.cxEvLevel | number: '1.2-2'}} V</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripdistance-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Trip Distance</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalTripDistance | number:'1.2-2'}} miles</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripduration-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Vehicle Run Time</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalVehicleDuration ?
                                        (formatDurationSeconds(tripDataNew?.totalVehicleDuration)) : 'NA' }}</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripduration-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Idling Duration</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalIdlingDuration ?
                                        (formatDurationSeconds(tripDataNew?.totalIdlingDuration)) : 'NA' }}</h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/top-speed.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Top Speed</h5>

                                      <h5 class="data-params">
                                        <ng-container
                                          *ngIf="tripDataNew?.maxSpeed <= -1 || tripDataNew?.maxSpeed == null">
                                          -- mph
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.maxSpeed > -1">
                                          {{ tripDataNew?.maxSpeed | number: '1.2-2' }} mph
                                        </ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/driver-score-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Driver Score</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore <= -1">
                                          0
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore > -1">
                                          {{tripDataNew?.avgDriverScore | number: '1.0-0'}} </ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/vehicle-status.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Vehicle Status</h5>
                                      <h5 class="data-params">Good</h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </ng-container>
                            <ng-container
                              *ngIf="tripDataNew?.vehicleType === 'HEV' || tripDataNew?.vehicleType === 'PHEV'">
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/speed-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Average Speed</h5>
                                      <h5 class="data-params"> {{(tripDataNew?.avgVehicleSpeed) |
                                        number:'1.2-2'}} mph</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/odometer-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Odometer</h5>
                                      <h5 class="data-params">{{tripDataNew?.maxOdometer | number:'1.2-2'}}
                                        miles</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/mileage-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Mileage</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage <= -1">
                                          0.00 mpg
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage > -1">
                                          {{tripDataNew?.vehicleAverage | number:'1.2-2'}} mpg</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/fuelconsumed-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Fuel Consumed</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.totalFuelConsumed <= -1">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelConsumed == null ">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelConsumed > -1">
                                          {{tripDataNew?.totalFuelConsumed | number:'1.0-2'}} gal</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/fuel-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Fuel Level</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgFuelLevel <= -1">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgFuelLevel == null">
                                          0.00 gal
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgFuelLevel > -1">
                                          {{tripDataNew?.avgFuelLevel | number:'1.0-2'}} gal</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/fuel-price.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Total Fuel Cost</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.totalFuelCost <= -1">
                                          0.00 $
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelCost === null || tripDataNew?.avgFuelLevel === 'NaN'">
                                          0.00 $
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalFuelCost > -1">
                                          {{tripDataNew?.totalFuelCost | number:'1.0-2'}} $</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div *ngIf="tripDataNew?.vehicleType !== 'HEV'" class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/battery-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-10">
                                      <h5 class="heading-params">EV Battery Consumed</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.totalBatteryConsumed <= -1">
                                          0.00 %
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalBatteryConsumed == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalBatteryConsumed > -1">
                                          {{tripDataNew?.totalBatteryConsumed | number:'1.2-2'}} %</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" *ngIf="tripDataNew?.vehicleType !== 'HEV'"  style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/battery-icons.svg"
                                        class="image-icon" style="margin-left: 4px;">
                                    </div>
                                    <div class="col-xs-12 col-lg-10">
                                      <h5 class="heading-params">EV Battery Level</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.cxEvLevel <= -1">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.cxEvLevel == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.cxEvLevel > -1">
                                          {{tripDataNew?.cxEvLevel | number:'1.2-2'}} %</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/ev-remain.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-10">
                                      <h5 class="heading-params">EV Battery Remaining</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.maxRemainingBattery <= -1">
                                          0.00 %
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.maxRemainingBattery == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.maxRemainingBattery > -1">
                                          {{tripDataNew?.maxRemainingBattery | number:'1.2-2'}} %</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/ev-range.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">EV Range</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgEvRangeMilesPerKwh <= -1">
                                          0.00 miles
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgEvRangeMilesPerKwh == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgEvRangeMilesPerKwh > -1">
                                          {{tripDataNew?.avgEvRangeMilesPerKwh | number:'1.2-2'}}
                                          miles</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripdistance-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Trip Distance</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalTripDistance | number:'1.2-2'}} miles</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripduration-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Vehicle Run Time</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalVehicleDuration ?
                                        (formatDurationSeconds(tripDataNew?.totalVehicleDuration)) : 'NA' }}</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripduration-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Idling Duration</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalIdlingDuration ?
                                        (formatDurationSeconds(tripDataNew?.totalIdlingDuration)) : 'NA' }}</h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/top-speed.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Top Speed</h5>
                                      <h5 class="data-params">{{tripDataNew?.maxSpeed | number: '1.2-2'}} mph
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/driver-score-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Driver Score</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore <= -1">
                                          0
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore > -1">
                                          {{tripDataNew?.avgDriverScore | number: '1.0-0'}} </ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/vehicle-status.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Vehicle Status</h5>
                                      <h5 class="data-params">Good</h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </ng-container>
                            <ng-container *ngIf="tripDataNew?.vehicleType === 'BEV'">
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/speed-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Average Speed</h5>
                                      <h5 class="data-params"> {{(tripDataNew?.avgVehicleSpeed) |
                                        number:'1.2-2'}} mph</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/odometer-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Odometer</h5>
                                      <h5 class="data-params">{{tripDataNew?.maxOdometer | number:'1.2-2'}}
                                        miles</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/mileage-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Mileage</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage <= -1">
                                          0.00 mpg
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.vehicleAverage > -1">
                                          {{tripDataNew?.vehicleAverage/80 | number:'1.2-2'}} mi/kWh</ng-container>
                                      </h5>
                                      <!--change mile to mpg-->
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/battery-icons.svg"
                                        class="image-icon" style="margin-left: 3px;">
                                    </div>
                                    <div class="col-xs-12 col-lg-10">
                                      <h5 class="heading-params">EV Battery Consumed</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.totalBatteryConsumed <= -1">
                                          0.00 %
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalBatteryConsumed == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalBatteryConsumed > -1">
                                          {{tripDataNew?.totalBatteryConsumed | number:'1.2-2'}} %</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/ev-range.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">EV Range</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgEvRangeMilesPerKwh <= -1">
                                          0.00 miles
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgEvRangeMilesPerKwh == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgEvRangeMilesPerKwh > -1">
                                          {{tripDataNew?.avgEvRangeMilesPerKwh | number:'1.2-2'}}
                                          miles</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/ev-remain.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-10">
                                      <h5 class="heading-params">EV Battery Remaining</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.maxRemainingBattery <= -1">
                                          0.00 %
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.maxRemainingBattery == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.maxRemainingBattery > -1">
                                          {{tripDataNew?.maxRemainingBattery | number:'1.2-2'}} %</ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripdistance-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Trip Distance</h5>
                                      <h5 class="data-params"> {{ tripDataNew?.totalTripDistance | number:'1.2-2'}} miles</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripduration-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Vehicle Run Time</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalVehicleDuration ?
                                        (formatDurationSeconds(tripDataNew?.totalVehicleDuration)) : 'NA' }}</h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/tripduration-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Idling Duration</h5>
                                      <h5 class="data-params"> {{tripDataNew?.totalIdlingDuration ?
                                        (formatDurationSeconds(tripDataNew?.totalIdlingDuration)) : 'NA' }}</h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row" style="margin-top: 12px; margin-bottom: 12px;">
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/top-speed.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Top Speed</h5>
                                      <h5 class="data-params">{{tripDataNew?.maxSpeed | number: '1.2-2'}} mph
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/driver-score-icons.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Driver Score</h5>
                                      <h5 class="data-params">
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore <= -1">
                                          0
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore == null">
                                          NA
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.avgDriverScore > -1">
                                          {{tripDataNew?.avgDriverScore | number: '1.0-0' }} </ng-container>
                                      </h5>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xs-12 col-lg-4">
                                  <div class="row">
                                    <div class="col-xs-12 col-lg-2">
                                      <img src="../../../../../../../../assets/images/vehicle-status.svg"
                                        class="image-icon">
                                    </div>
                                    <div class="col-xs-12 col-lg-8">
                                      <h5 class="heading-params">Vehicle Status</h5>
                                      <h5 class="data-params">Good</h5>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </ng-container>
                          </div>
                          <!-- Trip details like fuel consumed, address, odomerter and more end-->
                          <!-- Trip on Map-->
                          <div class="col-md-6">
                            <div class="map-container">
                              <div class="map-card">
                                <div class="flex-display">
                                  <div class="row">
                                  <div class="col-md" style="width: 17%!important; margin-right: 0px;  border-right: 1px dotted rgb(183, 180, 180);">
                                    <div class="flex-display" style="padding-right: 0.5rem;">
                                      <div class="">
                                        <img src="../../../../../../../../assets/images/HA-TH.svg" alt=""
                                          height="17px" />
                                      </div>
                                      <div class="">
                                        <div class="map-card-text">Harsh<br>Acceleration</div>
                                        <div class="map-main-text">{{tripDataNew?.totalHarshAccelerationCount}}
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md"  style="width: 17%!important; margin-right: 0px;   border-right: 1px dotted rgb(183, 180, 180);">
                                    <div class="flex-display" style="padding-right: 0.5rem;">
                                      <div class="">
                                        <img src="../../../../../../../../assets/images/HB-TH.svg" alt=""
                                          height="17px" />
                                      </div>
                                      <div class="">
                                        <div class="map-card-text">Harsh<br>Braking</div>
                                        <div class="map-main-text">{{tripDataNew?.totalHarshBrakingCount}}</div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md" style="width: 17%!important; margin-right: 0px;   border-right: 1px dotted rgb(183, 180, 180);">
                                    <div class="flex-display" style="padding-right: 0.5rem;">
                                      <div class="">
                                        <img src="../../../../../../../../assets/images/HC-TH.svg" alt=""
                                          height="17px" />
                                      </div>
                                      <div class="">
                                        <div class="map-card-text">Harsh Cornering</div>
                                        <div class="map-main-text">{{tripDataNew?.totalHarshCorneringCount}}
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md"  style="width: 24.5%!important;;   border-right: 1px dotted rgb(183, 180, 180);">
                                    <div class="flex-display" style="padding-right: 0.5rem; width: 134px;">
                                      <div class="">
                                        <img src="../../../../../../../../assets/images/OS-TH.svg" alt=""
                                          height="17px" />
                                      </div>
                                      <div style="width: 107px;">
                                        <div class="map-card-text">Over<br> Speeding (miles)</div>
                                        <div class="map-main-text">
                                          <ng-container *ngIf="tripDataNew?.totalOverspeedingDistance === -1">
                                            --
                                           </ng-container>
                                          <ng-container *ngIf="tripDataNew?.totalOverspeedingDistance != -1">
                                            {{tripDataNew?.totalOverspeedingDistance | number:'1.2-2'}}
                                           </ng-container>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md"  style="width: 24.5%!important;">
                                    <div class="flex-display" style="padding-right: 0.5rem; width: 134px;">
                                      <div class="">
                                        <img src="../../../../../../../../assets/images/ND-TH.svg" alt=""
                                          height="17px" />
                                      </div>
                                      <div style="width: 107px;">
                                        <div class="map-card-text">Night <br>Driving (miles)</div>
                                        <div class="map-main-text">
                                        <ng-container *ngIf="tripDataNew?.totalNightDistance === -1">
                                         --
                                        </ng-container>
                                        <ng-container *ngIf="tripDataNew?.totalNightDistance != -1">
                                          {{tripDataNew?.totalNightDistance | number:'1.2-2'}}
                                        </ng-container>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                </div>
                              </div>
                              <div class="map-container">
                                <agm-map [latitude]="lat" [longitude]="lng" [styles]="mapStyles"
                                  [style.height]="
                                    tripDataNew?.vehicleType === 'BEV' ? '500' :
                                    tripDataNew?.vehicleType === 'PHEV, HEV' ? '500' :
                                    (tripDataNew?.vehicleType === 'Gasoline, Diesel, Flexible Fuel Vehicle (FFV)' ? '500' : '500')"
                                  [mapTypeId]="currentMapType" class="map-heights" [zoom]="zoom"
                                  [fullscreenControl]="true">
<!-- Start and End Markers -->
<agm-marker *ngFor="let coordinate of start_end_mark; let i = index"
[latitude]="coordinate[0]" [longitude]="coordinate[1]"
[iconUrl]="{
url: coordinate[2].iconUrl,
scaledSize: { height: 15, width: 15 }
}">
</agm-marker>

<!-- Alert Markers -->
<agm-marker *ngFor="let alert of alertMarkers"
[latitude]="alert.lat"
[longitude]="alert.lng"
[iconUrl]="{
url: alert.iconUrl,
scaledSize: { height: 25, width: 25 }
}"
[title]="alert.title">
</agm-marker>

<!-- Main Polyline (Default Color) -->
<agm-polyline [visible]="true" [strokeWeight]="4" [strokeColor]="'#28D459'">
<agm-polyline-point *ngFor="let coordinate of wayPoints"
[latitude]="coordinate[0]" [longitude]="coordinate[1]">
</agm-polyline-point>
</agm-polyline>
                                </agm-map>

                                <div class="map-controls">
                                  <button (click)="toggleMapType()" class="map-toggle-button"
                                    [ngClass]="{'roadmap-bg': currentMapType === 'roadmap', 'satellite-bg': currentMapType === 'satellite'}">
                                    <span>{{ currentMapType === 'roadmap' ? 'Roadmap' : 'Satellite' }} </span>
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                          <!-- Trip on Map end-->
                        </div>
                      </td>
                    </tr>
                </ng-container>
                </ng-container>
                <ng-template #noDataTemplate>
                  <tr>
                    <td colspan="11" class="text-center">
                      <h5 class="heading-c" style="text-align: center;">No Data Found ...</h5>
                    </td>
                  </tr>
                </ng-template>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- Main data table end-->
      <!-- Pagination -->
      <div class="mt-2 text-end pagination-h">
        <!-- Number Pagination-->
        <span *ngIf="pages?.length <=9" class="f-le">
          <div>
            <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm pag-color" aria-label="Pagination">
              <a (click)="selectPages(pageNumber - 1)" href="javascript:(Void)" [class.disabled]="pageNumber == 1"
                class="page pointer relative inline-flex items-center rounded-l-md px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                <span class="sr-only">Previous</span>
                <img src="../../../../../assets/images/left-img.svg">
              </a>


              <ng-container *ngFor="let page of pages">
                <a [class.isActive]="page == pageNumber" href="javascript:(void)" [ngClass]="{'pointer' : page != '...'}"
                  aria-current="page" (click)="selectPages(page)" class=" px-4 py-2 pageination-number">{{page}}
                </a>
              </ng-container>


              <a (click)="selectPages(pageNumber + 1)" [class.disabled]="pageNumber == totalPages"
                class=" page pointer relative inline-flex items-center rounded-r-md px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                <span class="sr-only">Next</span>
                <img src="../../../../../assets/images/right.svg">
              </a>
            </nav>
          </div>
        </span>
        <span *ngIf="pages?.length >9" class="f-le">
          <div>
            <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
              <a (click)="selectPages(pageNumber - 1)" [class.disabled]="pageNumber == 1"
                class="page pointer relative inline-flex items-center rounded-l-md px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                <span class="sr-only">Previous</span>
                <img src="../../../../../assets/images/left-img.svg">
              </a>

              <ng-container *ngFor="let page of pages">
                <a [class.isActive]="page == pageNumber" *ngIf="( (page < pages.length && page  > 1))" aria-current="page"
                  (click)="selectPages(page)"
                  [ngStyle]="{'display': ((page > pageNumber+1 ||  page < pageNumber-1) && page < (pages.length)) ? 'none':''}"
                  class=" px-4 py-2 pageination-number">{{page}}
                </a>
              </ng-container>

              <ng-container *ngIf="pageNumber < (pages.length-2)">
                <a aria-current="page" (click)="selectPages(pageNumber+1)"
                  class="page relative z-10 inline-flex items-center  px-4 py-2 text-sm font-medium text-indigo-600 focus:z-20 active:bg-blue-700 focus:bg-blue-500 hover:bg-blue-700 hover:text-white ">{{"."}}
                </a>
              </ng-container>

              <ng-container>
                <a aria-current="page" [class.isActive]="(pageNumber == pages.length )" (click)="selectPages(pages.length)"
                  class=" px-4 py-2 pageination-number">{{pages.length}}
                </a>
              </ng-container>

              <ng-container *ngFor="let page of pages">
                <a [class.isActive]="page == pageNumber" class="page-display" aria-current="page"
                  (click)="selectPages(page)" class=" px-4 py-2 pageination-number">{{page}}
                </a>
              </ng-container>


              <a (click)="selectPages(pageNumber + 1)" [class.disabled]="pageNumber == totalPages"
                class=" page relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                <span class="sr-only">Next</span>
                <img src="../../../../../assets/images/right.svg">
              </a>
            </nav>
          </div>
        </span>
        <!-- Number Pagination End-->
         <!-- Page Size Pagination-->
        <span class="f-ri">
          <select class="form-select" (change)="selectPage($event.target.value)" [(ngModel)]="pageSize">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="40">40</option>
            <option value="80">80</option>
            <option value="100">100</option>
          </select>
        </span>
        <span class="pageination">Per Page</span>
         <!-- Page Size Pagination End-->
      </div>
      <!-- Pagination End -->
    </div>
    <!-- Right side menu end-->
  </div>
</div>
<!--Main content-->
<!--Failure reason when click on info-->
<ng-template #remarks let-modal class="modal-width">
  <div class="modal-header">
    <h5 class="modal-title mt-0 font-weight-bold">Failed Reason</h5>
    <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')" aria-hidden="true"></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xs-12 col-lg-12 failure-box">
        {{selectedFailureReason}}
      </div>
    </div>
  </div>
</ng-template>
<!--Failure reason when click on info end-->

<div class="modal-overlay" *ngIf="isCardOpen">
  <div class="modal-card">
      <button (click)="closeCard()" class="close-button">X</button>
      <div class=" row">
          <div class="col-3 option-column" style="    margin-left: -20px;
  margin-right: 12px;">
              <div style="margin-top: 20px;">
                  <div class="option" [class.selected]="selectedOption === 'yesterday'"
                      (click)="handleOption('yesterday')">Yesterday</div>
                  <div class="option" [class.selected]="selectedOption === 'weekly'" (click)="handleOption('weekly')">
                      Current Week</div>
                  <div class="option" [class.selected]="selectedOption === 'monthly'"
                      (click)="handleOption('monthly')">Current Month</div>
                  <div class="option" [class.selected]="selectedOption === 'lastmonth'"
                      (click)="handleOption('lastmonth')">Previous Month</div>
                  <div class="option" [class.selected]="selectedOption === 'customRange'" selected
                      (click)="handleOption('customRange')">Custom Range</div>
              </div>
          </div>

          <div class="col-9" style="margin-top:20px;">

              <!-- Display calendar only if 'custom-range' is selected -->
              <app-calendar (dateRangeSelected)="onDateRangeSelected($event);closeCard()"></app-calendar>
          </div>
      </div>
  </div>
</div>

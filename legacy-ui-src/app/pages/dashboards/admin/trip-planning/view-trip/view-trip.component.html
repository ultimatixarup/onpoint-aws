<ngx-spinner bdColor="rgba(0,0,0,0.8)" size="large" color="#fff" type="ball-elastic-dots" [fullScreen]="true" >
  <div class="custom-spinner">
    <img src="../../../../../assets/images/spinner3.svg" alt="Your Logo">
  </div>
  <div class="loading-text">Please wait, we are getting information...</div>
</ngx-spinner>
<div class="page-content page-content-main">
  <div class="row" style="margin-left: -31px; margin-right: 0px; margin-top: 15px;">
    <!-- Left Sidebar -->
    <div class="col-xs-12 col-lg-2 navbar-side-menu">
      <app-sidebar></app-sidebar>
    </div>
    <!-- Left Sidebar End -->

    <!-- Right Side Content -->
    <div class="col-xs-12 col-lg-12">
      <div class="page-content-main">
        <div class="row">
          <div class="col-xs-12 col-lg-12">
            <span class="breadcrumb-left">
              <h1 class="login-headline heading-title">
                Trip
                <span class="heading-title-small">Details</span>
              </h1>
            </span>
            <span class="breadcrumb-right mr-8">
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a routerLink="/adlp/admin" class="breadcrumb-h6">
                    <i class="bx bx-home-circle"></i>
                  </a>
                </li>
                <li class="breadcrumb-item inactive-bread">
                  <a routerLink="/adlp/admin/admindashboard/dashboardfleet">Dashboard</a>
                </li>
                <li class="breadcrumb-item text-selected active-bread">Trip Details</li>
              </ol>
            </span>
          </div>
        </div>

        <div class="trip-details-container mt-4">
          <!-- Show message when no trip data is available -->
          <div class="alert alert-info text-center" *ngIf="!tripData && !isLoading">
            <i class="bx bx-info-circle" style="font-size: 24px;"></i>
            <h5 class="mt-2">No trip details available. Please check the trip ID.</h5>
          </div>

          <div class="card shadow-sm" *ngIf="tripData">
            <div class="card-header bg-primary text-white">
              <div class="row align-items-center">
                <div class="col-md-6">
                  <h4 class="mb-0"><i class="bx bx-trip"></i> Trip Details</h4>
                </div>
                <div class="col-md-6 text-end">
                  <span class="badge bg-light text-dark">Trip ID: {{tripId}}</span>
                </div>
              </div>
            </div>
            <div class="card-body p-4">
              <!-- Trip Information Section -->
              <div class="row mb-4">
                <div class="col-md-3" *ngFor="let field of [
                    {label: 'Trip Name', value: tripData?.tripName || 'N/A', icon: 'bx-map'},
                    {label: 'Scheduled Start Time', value: convertToTimeZone(tripData?.tripStartDateTime, tripData?.timeZone), icon: 'bx-time'},
                    {label: 'Driver Name', value: tripData?.driverName || 'N/A', icon: 'bx-user'},
                    {label: 'Vehicle Name', value: tripData?.vinAlias || 'N/A', icon: 'bx-car'}
                  ]">
                  <div class="info-card">
                    <div class="info-label">
                      <i class="bx {{field.icon}}"></i> {{ field.label }}
                    </div>
                    <div class="info-value">{{ field.value }}</div>
                  </div>
                </div>
              </div>

              <!-- Delivery Locations Section -->
              <div class="mt-4">
                <h5 class="section-title mb-3">
                  <i class="bx bx-map-pin"></i> Delivery Locations
                </h5>
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Name</th>
                        <th scope="col">Contact</th>
                        <th scope="col">Address</th>
                        <th scope="col">Type</th>
                        <!-- <th scope="col">Arrival Time</th>
                        <th scope="col">Departure Time</th> -->
                        <th scope="col">Halt Time (min)</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let locationAddress of deliveryLocationsNew; let i = index">
                        <td>{{ i + 1 }}</td>
                        <td>
                          <strong>{{locationAddress?.name || 'N/A'}}</strong>
                        </td>
                        <td>
                          <div *ngIf="locationAddress?.phone || locationAddress?.email">
                            <div *ngIf="locationAddress?.phone">
                              <i class="bx bx-phone"></i> {{locationAddress.phone}}
                            </div>
                            <div *ngIf="locationAddress?.email" class="text-muted small">
                              <i class="bx bx-envelope"></i> {{locationAddress.email}}
                            </div>
                          </div>
                          <span *ngIf="!locationAddress?.phone && !locationAddress?.email">N/A</span>
                        </td>
                        <td>
                          <div class="address-cell">
                            {{ locationAddress?.streetAddress || 'N/A' }}<br>
                            <span class="text-muted small">
                              {{ locationAddress?.city || '' }}{{ locationAddress?.city && locationAddress?.state ? ', ' : '' }}{{ locationAddress?.state || '' }} {{ locationAddress?.zipcode || '' }}
                            </span>
                          </div>
                        </td>
                        <td>
                          <span class="badge"
                                [ngClass]="{
                                  'bg-success': locationAddress?.type === 'START',
                                  'bg-info': locationAddress?.type === 'DELIVERY',
                                  'bg-danger': locationAddress?.type === 'END'
                                }">
                            {{ locationAddress?.type || 'N/A' }}
                          </span>
                        </td>
                        <!-- <td>
                          <small>{{ locationAddress?.localTimeOfArrival || 'N/A' }}</small>
                        </td>
                        <td>
                          <small>{{ locationAddress?.localTimeOfDeparture || 'N/A' }}</small>
                        </td> -->
                        <td class="text-center">
                          {{ tripData?.defaultHaltTime || 'N/A' }}
                        </td>
                      </tr>
                      <tr *ngIf="!deliveryLocationsNew || deliveryLocationsNew.length === 0">
                        <td colspan="8" class="text-center py-4">
                          <i class="bx bx-info-circle" style="font-size: 24px; color: #6c757d;"></i>
                          <p class="text-muted mt-2">No delivery locations found...</p>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Right Side Content End -->
  </div>
</div>

<!-- Modal for displaying map -->
<!-- <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close rounded-circle p-2 border border-1 fs-6" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3557.417505776218!2d78.0271616!3d27.2171008!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMjfCsDEyJzE2LjEiTiA3OMKwMDEnMzcuNiJF!5e0!3m2!1sen!2sin!4v1693144577071!5m2!1sen!2sin"
          width="100%"
          height="400"
          style="border:0;"
          allowfullscreen=""
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>
    </div>
  </div>
</div> -->

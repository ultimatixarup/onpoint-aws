<!-- Live Tracking Component -->
<div class="page-content page-content-main">
   <div class="row" style="margin-left: 0px; margin-right: 0px;">
      <!-- Left Sidebar -->
      <div class="col-xs-12 col-lg-2 navbar-side-menu">
        <app-sidebar></app-sidebar>
      </div>
      <!-- Left Sidebar End -->

      <!-- Right Side Content -->
         <div class="col-xs-12 col-lg-10 content-right">
        <!-- Breadcrumb and Filter -->
        <div class="page-content-main">
          <div class="row">
            <div class="col-xs-12 col-lg-12">
              <span class="breadcrumb-left">
                <h1 class="login-headline heading-title">
                  Route <span class="heading-title-small">Optimizaton</span>
                </h1>
                <!-- <ng-container *ngIf="user ==='role_user_fleet'">
                  <div class="content-text">
                    <span class="vin_container">
                      <span class="content-sub-text">Fleet Id</span>
                    </span>
                    <span class="content-sub-text2">{{ selectedFleetDisplay || fleetIdValueNew }}</span>
                  </div>
                </ng-container> -->
              </span>
              <span class="breadcrumb-right mr-8">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item">
                    <a routerLink="/adlp/admin" class="breadcrumb-h6"><i class="bx bx-home-circle"></i></a>
                  </li>
                  <li class="breadcrumb-item inactive-bread">
                    <a routerLink="/adlp/admin/admindashboard/dashboardfleet">Dashboard</a>
                  </li>
                  <li class="breadcrumb-item text-selected active-bread">Route Optimizaton</li>
                </ol>
              </span>
            </div>
          </div>

          <!-- Fleet Id Filter (aligned like Trip Planning, without groups) -->
          <div class="row consumer-pad justify-content-end my-2" *ngIf="user !='role_user_fleet'">
            <div class="col-xs-12 col-lg-2 mr-3">
              <ng-select
                [searchable]="true"
                class="newSelect1"
                [clearable]="true"
                placeholder="Organization Id/Name"
                (clear)="clearFleetSelection()"
                (change)="selectFleetId()"
                [(ngModel)]="fleetIdData">
                <ng-option *ngFor="let fleet of fleetList" [value]="fleet.id">
                  {{fleet.id}} - [{{fleet.name}}]
                </ng-option>
              </ng-select>
            </div>
          </div>
          <!-- Fleet Id Filter end -->


          <!-- Table for Trip Details -->
          <div class="row mr-table" style="margin-top: 24px">
            <div class="col-lg-12 col-xs-12">
              <div class="table-responsive table-b">
                <table class="table">
                  <thead class="table-head">
                    <tr>
                      <th style="width: 15%;">Name</th>
                      <th style="width: 15%;">Start Location</th>
                      <th style="width: 15%;">Start Date</th>
                      <th style="width: 15%;">Start Time</th>
                      <th style="width: 15%;">Status</th>
                      <th style="width: 15%;">Stops</th>
                      <th style="width: 15%;">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngIf="loading">
                      <tr>
                        <td colspan="7">
                          <h5 class="heading-c">Loading...</h5>
                        </td>
                      </tr>
                    </ng-container>
                    <ng-container *ngIf="!loading && trips.length > 0">
                      <tr *ngFor="let trip of trips">
                        <td>{{ trip.tripName }}</td>
                        <td>
                          {{ trip.deliveryLocations[0]?.streetAddress || 'N/A' }},
                          {{ trip.deliveryLocations[0]?.city || 'N/A' }},
                          {{ trip.deliveryLocations[0]?.state || 'N/A' }}
                        </td>
                        <td>{{ trip.tripStartDateTime | date: 'yyyy-MM-dd' }}</td>
                        <td>{{ trip.tripStartDateTime | date: 'hh:mm a' }}</td>
                        <td>{{ formatStatus(trip.status)}}</td>
                        <td>{{ trip.deliveryLocations.length }}</td>
                        <td class="text-center">
                          <div class="btn-group" role="group">

                            <button class="btn btn-info btn-sm" [routerLink]="['/adlp/admin/admindashboard/trip-planning/route-optimization', trip.id]">
                              <i class="fas fa-route"></i>
                            </button>

                          </div>
                        </td>
                      </tr>
                    </ng-container>
                    <ng-container *ngIf="!loading && trips.length === 0">
                      <tr>
                        <td colspan="7">
                          <h5 class="heading-c">No Data Found ...</h5>
                        </td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <!-- Table for Trip Details End -->

          <!-- Pagination -->
          <div class="mt-2 text-end pagination-h">
            <!-- Number Pagination-->
            <span *ngIf="pages?.length <=9" class="f-le">
              <div>
                <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm pag-color" aria-label="Pagination">
                  <a (click)="selectPages(pageNumber - 1)" href="javascript:(Void)" [class.disabled]="pageNumber == 1"
                    class="page pointer relative inline-flex items-center rounded-l-md px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                    <span class="sr-only">Previous</span>
                    <img src="../../../../../assets/images/left-img.svg">
                  </a>


                  <ng-container *ngFor="let page of pages">
                    <a [class.isActive]="page == pageNumber" href="javascript:(void)" [ngClass]="{'pointer' : page != '...'}"
                      aria-current="page" (click)="selectPages(page)" class=" px-4 py-2 pageination-number">{{page}}
                    </a>
                  </ng-container>


                  <a (click)="selectPages(pageNumber + 1)" [class.disabled]="pageNumber == totalPages"
                    class=" page pointer relative inline-flex items-center rounded-r-md px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                    <span class="sr-only">Next</span>
                    <img src="../../../../../assets/images/right.svg">
                  </a>
                </nav>
              </div>
            </span>
            <span *ngIf="pages?.length >9" class="f-ri">
              <div>
                <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
                  <a (click)="selectPages(pageNumber - 1)" [class.disabled]="pageNumber == 1"
                    class="page pointer relative inline-flex items-center rounded-l-md px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                    <span class="sr-only">Previous</span>
                    <img src="../../../../../assets/images/left-img.svg">
                  </a>

                  <ng-container *ngFor="let page of pages">
                    <a [class.isActive]="page == pageNumber" *ngIf="( (page < pages.length && page  > 1))" aria-current="page"
                      (click)="selectPages(page)"
                      [ngStyle]="{'display': ((page > pageNumber+1 ||  page < pageNumber-1) && page < (pages.length)) ? 'none':''}"
                      class=" px-4 py-2 pageination-number">{{page}}
                    </a>
                  </ng-container>

                  <ng-container *ngIf="pageNumber < (pages.length-2)">
                    <a aria-current="page" (click)="selectPages(pageNumber+1)"
                      class="page relative z-10 inline-flex items-center  px-4 py-2 text-sm font-medium text-indigo-600 focus:z-20 active:bg-blue-700 focus:bg-blue-500 hover:bg-blue-700 hover:text-white ">{{"."}}
                    </a>
                  </ng-container>

                  <ng-container>
                    <a aria-current="page" [class.isActive]="(pageNumber == pages.length )" (click)="selectPages(pages.length)"
                      class=" px-4 py-2 pageination-number">{{pages.length}}
                    </a>
                  </ng-container>

                  <ng-container *ngFor="let page of pages">
                    <a [class.isActive]="page == pageNumber" class="page-display" aria-current="page"
                      (click)="selectPages(page)" class=" px-4 py-2 pageination-number">{{page}}
                    </a>
                  </ng-container>


                  <a (click)="selectPages(pageNumber + 1)" [class.disabled]="pageNumber == totalPages"
                    class=" page relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
                    <span class="sr-only">Next</span>
                    <img src="../../../../../assets/images/right.svg">
                  </a>
                </nav>
              </div>
            </span>
            <!-- Number Pagination End-->
             <!-- Page Size Pagination-->
            <span class="f-ri">
              <select class="form-select" (change)="selectPage($event.target.value)" [(ngModel)]="pageSize">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="40">40</option>
                <option value="80">80</option>
                <option value="100">100</option>
              </select>
            </span>
            <span class="pageination">Per Page</span>
             <!-- Page Size Pagination End-->
          </div>
          <!-- Pagination End -->
        </div>
      </div>
      <!-- Right Side Content End -->
    </div>
  </div>
  <!-- Live Tracking Component End -->

  <!-- Delete Confirmation Modal -->
  <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteConfirmModalLabel">Confirm Deletion</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this trip? This action cannot be undone.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" (click)="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Delete Confirmation Modal End -->
